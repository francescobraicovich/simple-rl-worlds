Running on node: gnode02
Using 4 CPU cores
CUDA devices available:
Mon Jul 14 01:10:15 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 530.30.02              Driver Version: 530.30.02    CUDA Version: 12.1     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                  Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf            Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe           On | 00000000:17:00.0 Off |                    0 |
| N/A   32C    P0               45W / 300W|      0MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe           On | 00000000:65:00.0 Off |                    0 |
| N/A   29C    P0               42W / 300W|      0MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+

Running stage: model_init
üöÄ MODEL INITIALIZATION AND PARAMETER ANALYSIS
================================================================================
Using device: cuda

üìä Initializing models...

1. Initializing Encoder...
2. Initializing Predictor...
3. Initializing Decoder...
4. Initializing Reward Predictor...

‚úÖ All models initialized successfully!

============================================================
ENCODER MODEL INFORMATION
============================================================
Model Class: VideoViT
Total Parameters: 4.75M (4,751,104)
Trainable Parameters: 4.75M (4,751,104)
Non-trainable Parameters: 0 (0)

Model Architecture Summary:
  Device: cuda:0
  Dtype: torch.float32
  Layer Types:
    DropPath: 12
    Dropout: 18
    GELU: 6
    LayerNorm: 13
    Linear: 24
    MLP: 6
    MultiHeadSelfAttention: 6
    RotaryEmbedding: 6
    TransformerBlock: 6

============================================================
PREDICTOR MODEL INFORMATION
============================================================
Model Class: LatentDynamicsPredictor
Total Parameters: 3.23M (3,226,880)
Trainable Parameters: 3.23M (3,226,880)
Non-trainable Parameters: 0 (0)

Model Architecture Summary:
  Device: cuda:0
  Dtype: torch.float32
  Layer Types:
    DropPath: 8
    Dropout: 12
    GELU: 4
    LayerNorm: 9
    Linear: 17
    MLP: 4
    MultiHeadSelfAttention: 4
    RotaryEmbedding: 4
    TransformerBlock: 4

============================================================
DECODER MODEL INFORMATION
============================================================
Model Class: HybridConvTransformerDecoder
Total Parameters: 15.68M (15,683,841)
Trainable Parameters: 15.68M (15,683,841)
Non-trainable Parameters: 0 (0)

Model Architecture Summary:
  Device: cuda:0
  Dtype: torch.float32
  Layer Types:
    Conv3d: 7
    DropPath: 3
    Dropout: 6
    GELU: 3
    LayerNorm: 3
    Linear: 11
    MultiHeadCrossAttention: 3
    ResidualConvBlock3D: 3
    RotaryEmbedding: 3
    Upsample: 3
    UpsampleBlock: 3

============================================================
REWARD PREDICTOR MODEL INFORMATION
============================================================
Model Class: RewardPredictor
Total Parameters: 339.97K (339,969)
Trainable Parameters: 339.97K (339,969)
Non-trainable Parameters: 0 (0)

Model Architecture Summary:
  Device: cuda:0
  Dtype: torch.float32
  Layer Types:
    Dropout: 4
    GELU: 3
    LayerNorm: 6
    Linear: 6
    ModuleList: 2
    MultiheadAttention: 3
    NonDynamicallyQuantizableLinear: 3

============================================================
SUMMARY - ALL MODELS COMBINED
============================================================
Total Parameters (All Models): 24.00M (24,001,794)
Trainable Parameters (All Models): 24.00M (24,001,794)
Non-trainable Parameters (All Models): 0 (0)

Parameter Distribution:
  Encoder: 4.75M (19.8%)
  Predictor: 3.23M (13.4%)
  Decoder: 15.68M (65.3%)
  Reward Predictor: 339.97K (1.4%)

üéâ Model initialization completed successfully!
================================================================================

Running stage: data_collection
Loading dataset from datasets/assault_rep_4.pth...
Successfully loaded PPO-collected dataset for 'ALE/Assault-v5'.
Data loaded: 44277 training samples, 10913 validation samples
len(train_dataset):  44277

‚úì Data collection and loading completed successfully!
‚úì Training DataLoader ready with 691 batches
‚úì Validation DataLoader ready with 171 batches

Running stage: encoder_decoder
wandb: Currently logged in as: francesco-braicovich (francesco-braicovich-bocconi-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.21.0
wandb: Run data is saved locally in /home/3157425/rl-worlds/simple-rl-worlds/wandb/run-20250714_011031-3rsfihgy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run encoder-decoder-20250714-011031
wandb: ‚≠êÔ∏è View project at https://wandb.ai/francesco-braicovich-bocconi-university/simple-rl-worlds
wandb: üöÄ View run at https://wandb.ai/francesco-braicovich-bocconi-university/simple-rl-worlds/runs/3rsfihgy
